(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e){e.exports=JSON.parse('{"home":"principal","about":"informaci\xf3n","nests":"db","dashboard":"panel de control","nests-insert":"a\xf1adir nidos","username":"usuario","password":"contrase\xf1a","register":"registrarse","login":"entrar","logout":"cerrar","street":"calle","house_number_name":"No. / nombre","lat":"latitud","lon":"longitud","type":"construcci\xf3n","window":"ventana","cornice":"cornisa","crack":"grieta","cables":"cable","gable":"tejado","balcony":"balc\xf3n","facing":"orientaci\xf3n","N":"norte","NE":"norteste","E":"este","SE":"sudeste","S":"sur","SW":"sudoeste","W":"oeste","NW":"nortoeste","true":"Si","false":"No","destroyed":"destruida","date":"fecha","species":"especie","swift":"vencejo com\xfan","swallow":"golondrina com\xfan","martin":"avi\xf3n com\xfan","pallid_swift":"vencejo p\xe1lido","red_rumped_swallow":"golondrina d\xe1urica","height":"altura (en metros) ","qty":"cantidad","destroyed_date":"fecha de destrucci\xf3n","submit":"enviar","delete":"borrar ","delete_entry":"borrar entrada","update":"actualizar","logged_as":"session ","update_entry":"actualiza entrada","address":"direcci\xf3n","map_title":"distribuci\xf3n geografica","key":"clave","totalNests":"Nidos Total","totalDestroyed":"Nidos destruidos","totalCurrent":"Nidos actuales","visualizations":"Visualizaciones"}')},104:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),r=a(27),s=a.n(r),c=a(10),i=a(8),o=a.n(i),u=a(9),d=a(64),m=a.n(d);var p=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/transit",e.abrupt("return",new Promise((function(e){var t;e((t="/transit",function(){var e=Object(u.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m()({method:"GET",url:t,headers:{"Content-Type":"application/json",Accept:"application/json"}});case 3:return a=e.sent,e.abrupt("return",a);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}()()))})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=a(49),f={title:"Nests counted by species",width:800,height:500,mark:{type:"bar",cornerRadiusEnd:4},encoding:{x:{aggregate:"count",field:"*",type:"quantitative"},y:{field:"species",type:"nominal"}}},h=function(){var e=Object(n.useState)({values:[]}),t=Object(c.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){p().then((function(e){if(e){var t=e.data?e.data:"boo";r({values:t})}}))}),[]),l.a.createElement(l.a.Fragment,null,l.a.createElement(E.a,{spec:f,data:a}),";")};var g=function(){return l.a.createElement("div",null,l.a.createElement(h,null))},w=a(22),b=a(3),y=a(4),v=a(7),N=a(5),x=a(6),_=a(48),S=a.n(_),O=a(113),k=a(114),C=a(112),T=a(110),j=a(111),z=a(100);a(101);var F=function(e){var t=/\(([^)]+)\)/;return[parseFloat(t.exec(e)[1].split(",")[0]),parseFloat(t.exec(e)[1].split(",")[1])]},D=function(e){function t(){var e,a;Object(b.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(v.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(r)))).state={entries:[{gps:"(36.253, -5.965)"},{gps:"(36.25302, -5.9655)"}],totalEntries:[{gps:"(36.253, -5.965)"},{gps:"(36.25302, -5.9655)"}],entriesInFrame:[{gps:"(36.253, -5.965)"},{gps:"(36.25302, -5.9655)"}],count:{swallowNests:0,martinNests:0,swiftNests:0,pallidSwiftNests:0,redrumpedSwallowNests:0,destroyedNests:0},visibility:"CURRENT",bounds:{southWest:{},northEast:{}},toggled:!1},a.handleGetData=function(){return p().then((function(e){var t;switch(a.setState(Object(w.a)({},a.state,{totalEntries:e.data})),a.state.visibility){case"TOTAL":t=a.state.totalEntries;break;case"CURRENT":t=a.state.totalEntries.filter((function(e){return!1===e.destroyed}));break;case"DESTROYED":t=a.state.totalEntries.filter((function(e){return!0===e.destroyed}))}a.setState(Object(w.a)({},a.state,{entries:t}))}))},a.position=[F(a.state.entries[0].gps)[0],F(a.state.entries[0].gps)[1]],a.circlePosition=[F(a.state.entries[1].gps)[0],F(a.state.entries[1].gps)[1]],a.handleColor=function(e){switch(e.species){case"swallow":return"#cc0000";case"swift":return"#3300ff";case"martin":return"#ffcc33";case"pallid_swift":return"#669999";case"red_rumped_swallow":return"#FF759C"}},a.handlePopup=function(e){return l.a.createElement("table",null,l.a.createElement("tr",null," ",l.a.createElement("td",null,l.a.createElement("b",null,"".concat(z.address,": "),": ")," ","".concat(e.street," ").concat(e.house_number_name," "))," "),l.a.createElement("tr",null," ",l.a.createElement("td",null,l.a.createElement("b",null,"".concat(z.height,": ")),"".concat(e.height," m "))," "),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("b",null,"".concat(z.facing,": ")),z[e.facing])),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("b",null,"".concat(z.type,": ")," "),z[e.type])),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("b",null,"".concat(z.date,": ")," "),S()(e.date).locale("es").format("ddd. D MMM YYYY"))))},a.handleTooltip=function(e){return l.a.createElement("table",null,l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("b",null,"lat/lon: ")," ","".concat(F(e.gps)[0]," ").concat(F(e.gps)[1]))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("b",null,"".concat(z.species,": ")),z[e.species])))},a.handleToggle=function(e){a.setState(Object(w.a)({},a.state,{visibility:e,toggled:!0})),console.log("state id -> ".concat(e))},a.Selector=function(){return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"btn-group btn-group-toggle"},l.a.createElement("label",{className:"btn btn-".concat("TOTAL"===a.state.visibility?"info":"secondary")},l.a.createElement("input",{type:"radio",name:"options",id:"total",autocomplete:"off",checked:!0,onClick:function(){return a.handleToggle("TOTAL")}})," ",z.totalNests),l.a.createElement("label",{className:"btn btn-".concat("CURRENT"===a.state.visibility?"info":"secondary")},l.a.createElement("input",{type:"radio",name:"options",id:"current",autocomplete:"off",onClick:function(){return a.handleToggle("CURRENT")}})," ",z.totalCurrent),l.a.createElement("label",{className:"btn btn-".concat("DESTROYED"===a.state.visibility?"info":"secondary")},l.a.createElement("input",{type:"radio",name:"options",id:"destroyed",autocomplete:"off",onClick:function(){return a.handleToggle("DESTROYED")}})," ",z.totalDestroyed)))},a.Summary=function(){return l.a.createElement("div",null,l.a.createElement("div",{className:"h3"}),l.a.createElement("table",{className:"table table-hover"},l.a.createElement("thead",null,l.a.createElement("tr",{className:"text-capitalize"},l.a.createElement("th",{scope:"col"},"#"),l.a.createElement("th",{scope:"col"},z.key),l.a.createElement("th",{scope:"col"},z.qty))),l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("th",{scope:"row",className:"text-capitalize"},"1."),l.a.createElement("td",null,z.totalNests),l.a.createElement("td",null,a.state.entriesInFrame.length)),l.a.createElement("tr",null,l.a.createElement("th",{scope:"row"},"2."),l.a.createElement("td",null,z.totalDestroyed),l.a.createElement("td",null,a.state.count.destroyedNests)),l.a.createElement("tr",null,l.a.createElement("th",{scope:"row"},"3."),l.a.createElement("td",null,z.totalCurrent),l.a.createElement("td",null,a.state.entriesInFrame.length-a.state.count.destroyedNests)),l.a.createElement("tr",null,l.a.createElement("th",{scope:"row"},"4."),l.a.createElement("td",{className:"text-capitalize"},z.swallow),l.a.createElement("td",null,a.state.count.swallowNests)),l.a.createElement("tr",null,l.a.createElement("th",{scope:"row"},"5."),l.a.createElement("td",{className:"text-capitalize"},z.swift),l.a.createElement("td",null,a.state.count.swiftNests)),l.a.createElement("tr",null,l.a.createElement("th",{scope:"row"},"6."),l.a.createElement("td",{className:"text-capitalize"},z.martin),l.a.createElement("td",null,a.state.count.martinNests)),l.a.createElement("tr",null,l.a.createElement("th",{scope:"row"},"7."),l.a.createElement("td",{className:"text-capitalize"},z.red_rumped_swallow),l.a.createElement("td",null,a.state.count.redrumpedSwallowNests)),l.a.createElement("tr",null,l.a.createElement("th",{scope:"row"},"8."),l.a.createElement("td",{className:"text-capitalize"},z.pallid_swift),l.a.createElement("td",null,a.state.count.pallidSwiftNests)))))},a.withinBounds=function(e){var t=F(e.gps);return t[0]>a.state.bounds.southWest.lat&&t[0]<a.state.bounds.northEast.lat&&t[1]>a.state.bounds.southWest.lng&&t[1]<a.state.bounds.northEast.lng},a.handleViewportChanged=function(){var e=a.refs.map.leafletElement.getBounds();a.setState(Object(w.a)({},a.state,{bounds:{northEast:{lat:e._northEast.lat,lng:e._northEast.lng},southWest:{lat:e._southWest.lat,lng:e._southWest.lng}},entriesInFrame:a.state.totalEntries.filter((function(e){return a.withinBounds(e)})),count:{swallowNests:a.state.entriesInFrame.filter((function(e){return"swallow"===e.species})).length,martinNests:a.state.entriesInFrame.filter((function(e){return"martin"===e.species})).length,swiftNests:a.state.entriesInFrame.filter((function(e){return"swift"===e.species})).length,pallidSwiftNests:a.state.entriesInFrame.filter((function(e){return"pallid_swift"===e.species})).length,redrumpedSwallowNests:a.state.entriesInFrame.filter((function(e){return"red_rumped_swallow"===e.species})).length,destroyedNests:a.state.entriesInFrame.filter((function(e){return!0===e.destroyed})).length}}))},a.Legend=function(){return l.a.createElement("div",null,l.a.createElement("span",{className:"text-capitalize"},l.a.createElement("svg",{width:"30px"},l.a.createElement("circle",{r:"10px",stroke:"#cc0000",fill:"#cc0000",opacity:"0.7",cx:"20",cy:"75"})),z.swallow),l.a.createElement("span",{className:"text-capitalize"},l.a.createElement("svg",{width:"30px"},l.a.createElement("circle",{r:"10px",opacity:"0.7",stroke:"#3300ff",fill:"#3300ff",cx:"20",cy:"75"})),z.swift),l.a.createElement("span",{className:"text-capitalize"},l.a.createElement("svg",{width:"30px"},l.a.createElement("circle",{r:"10px",stroke:"#669999",fill:"#669999",opacity:"0.7",cx:"20",cy:"75"})),z.pallid_swift," "),l.a.createElement("span",{className:"text-capitalize"},l.a.createElement("svg",{width:"30px"},l.a.createElement("circle",{r:"10px",stroke:"#FF759C",fill:"#FF759C",opacity:"0.7",cx:"20",cy:"75"})),z.red_rumped_swallow," "),l.a.createElement("span",{className:"text-capitalize"},l.a.createElement("svg",{width:"30px"},l.a.createElement("circle",{r:"10px",stroke:"#ffcc33",fill:"#ffcc33",opacity:"0.7",cx:"20",cy:"75"})),z.martin," "))},a}return Object(x.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){this.handleGetData()}},{key:"componentDidUpdate",value:function(){this.state.toggled&&(this.handleGetData(),this.setState(Object(w.a)({},this.state,{toggled:!1})))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement("div",{className:"container bp-2"},l.a.createElement("div",{className:"d-flex flex-row"},l.a.createElement("div",null,l.a.createElement("div",{className:"row",style:{padding:"1rem"}},this.Selector()),l.a.createElement("div",{className:"row"},l.a.createElement(O.a,{center:[36.253,-5.965],zoom:17,ref:"map",onViewportChange:function(){return e.handleViewportChanged()}},l.a.createElement(k.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png"}),this.state.entries.map((function(t){return l.a.createElement(C.a,{center:[F(t.gps)[0],F(t.gps)[1]],fillColor:e.handleColor(t),color:e.handleColor(t),radius:5},l.a.createElement(T.a,null,e.handlePopup(t)),l.a.createElement(j.a,null,e.handleTooltip(t)))})))),this.Legend()),l.a.createElement("div",{className:"m-4 pt-4"}," ",l.a.createElement("div",null,"La siguinte tabla es dinamica y se actualiza para representar los datos de la zona cuadrada en la ventanilla."),this.Summary()))))}}]),t}(n.Component);s.a.render(l.a.createElement(g,null),document.getElementById("new-app")),s.a.render(l.a.createElement(D,null),document.getElementById("map"))},72:function(e,t,a){e.exports=a(104)}},[[72,1,2]]]);
//# sourceMappingURL=main.4cc454c3.chunk.js.map